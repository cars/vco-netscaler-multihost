<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>
<workflow xmlns="http://vmware.com/vco/workflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://vmware.com/vco/workflow http://vmware.com/vco/workflow/Workflow-v4.xsd" root-name="item1" object-name="workflow:name=generic" id="056588c6-06e9-4ed1-81c9-a3f4818e9557"  version="0.0.12" api-version="3.1.0" allowed-operations="vef" restartMode="1" resumeFromFailedMode="0" >
<display-name><![CDATA[Add Virtual Server to Netscaler]]></display-name>
<position x='100.0' y='50.0'/>
<input><param name='PasswordID' type='String' >
<description><![CDATA[PasswordID]]></description>
</param>
<param name='vserverName' type='string' >
</param>
<param name='vserverProtocol' type='string' >
</param>
<param name='vserverIP' type='string' >
</param>
<param name='vserverPort' type='string' >
</param>
<param name='vserverLBMethod' type='string' >
</param>
<param name='vserverPersistence' type='string' >
</param>
<param name='vserverComment' type='string' >
</param>
<param name='sslCertKey' type='string' >
</param>
<param name='doSSL' type='boolean' >
<description><![CDATA[Assign an SSL Certificate]]></description>
</param>
<param name='nsRestHostName' type='string' >
</param>
</input><output><param name='sslBindingContentLength' type='Number' >
<description><![CDATA[Response content length]]></description>
</param>
<param name='sslBindingHeaders' type='Properties' >
<description><![CDATA[Response headers]]></description>
</param>
<param name='sslBindingContentAsString' type='String' >
<description><![CDATA[Response content as string]]></description>
</param>
<param name='addServerStatusCode' type='Number' >
<description><![CDATA[Response status code]]></description>
</param>
<param name='addServerContentLength' type='Number' >
<description><![CDATA[Response content length]]></description>
</param>
<param name='addServerHeaders' type='Properties' >
<description><![CDATA[Response headers]]></description>
</param>
<param name='addServerContentAsString' type='String' >
<description><![CDATA[Response content as string]]></description>
</param>
<param name='sslBindingStatusCode' type='Number' >
<description><![CDATA[Response status code]]></description>
</param>
</output><attrib name='password' type='string' read-only='false' ><value encoded='n'><![CDATA[]]></value>
</attrib>
<attrib name='username' type='string' read-only='false' ><value encoded='n'><![CDATA[]]></value>
</attrib>
<attrib name='content' type='String' read-only='false' ><value encoded='n'><![CDATA[]]></value>
<description><![CDATA[content]]></description>
</attrib>
<workflow-item name='item0' type='end' end-mode='0' >
<position x='724.5' y='109.04545454545453'/>
</workflow-item>
<workflow-item name='item1' out-name='item4' type='link' linked-workflow-id='f35412f6-e8ca-489f-929d-54b05ea0370b' >
<display-name><![CDATA[Get Username and Password from PasswordState]]></display-name>
<in-binding><bind name='PasswordID' type='String' export-name="PasswordID" ><description><![CDATA[PasswordID]]></description>
</bind>
</in-binding><out-binding><bind name='statusCode' type='Number' export-name="sslBindingStatusCode" ><description><![CDATA[Response status code]]></description>
</bind>
<bind name='password' type='string' export-name="password" ></bind>
<bind name='username' type='string' export-name="username" ></bind>
</out-binding><description><![CDATA[Workflow that given a particulat PasswordID from password state will look up the password and username associated with the ID for use in workflows...
]]></description>
<position x='204.5' y='55.40909090909091'/>
</workflow-item>
<workflow-item name='item3' out-name='item5' type='condition' alt-out-name='item0' comparator='0' >
<display-name><![CDATA[Add SSL Cert]]></display-name>
<script encoded='false'><![CDATA[//Generated by the system, cannot be edited
return (doSSL == true) ;]]></script>
<in-binding><bind name='doSSL' type='boolean' export-name="doSSL" ></bind>
</in-binding><condition name='doSSL' type='boolean' comparator='0' label='null' ><![CDATA[false]]></condition>
<position x='624.5' y='45.40909090909091'/>
</workflow-item>
<workflow-item name='item5' out-name='item0' type='link' linked-workflow-id='af095502-c172-4207-9dc8-4f0027811354' >
<display-name><![CDATA[Netscaler - Bind SSL Cert to vServer]]></display-name>
<in-binding><bind name='nsPassword' type='string' export-name="password" ></bind>
<bind name='sslCertKey' type='string' export-name="sslCertKey" ></bind>
<bind name='vserverName' type='string' export-name="vserverName" ></bind>
<bind name='nsUsername' type='string' export-name="username" ></bind>
</in-binding><out-binding><bind name='statusCode' type='Number' export-name="sslBindingStatusCode" ><description><![CDATA[Response status code]]></description>
</bind>
<bind name='contentLength' type='Number' export-name="sslBindingContentLength" ><description><![CDATA[Response content length]]></description>
</bind>
<bind name='headers' type='Properties' export-name="sslBindingHeaders" ><description><![CDATA[Response headers]]></description>
</bind>
<bind name='contentAsString' type='String' export-name="sslBindingContentAsString" ><description><![CDATA[Response content as string]]></description>
</bind>
</out-binding><description><![CDATA[Autogenerated workflow. Bind an existing SSL certificate on the Netscaler to a Virtual Server]]></description>
<position x='764.5' y='55.40909090909091'/>
</workflow-item>
<workflow-item name='item2' out-name='item3' type='link' linked-workflow-id='e4316507-0988-4aca-9b31-600193b0cefa' >
<display-name><![CDATA[NetScaler: Vserver Add]]></display-name>
<in-binding><bind name='content' type='String' export-name="content" ><description><![CDATA[content]]></description>
</bind>
<bind name='nsRestHostName' type='string' export-name="nsRestHostName" ></bind>
<bind name='nsUserName' type='string' export-name="username" ></bind>
<bind name='nsUserPassword' type='string' export-name="password" ></bind>
</in-binding><out-binding><bind name='statusCode' type='Number' export-name="addServerStatusCode" ><description><![CDATA[Response status code]]></description>
</bind>
<bind name='contentLength' type='Number' export-name="addServerContentLength" ><description><![CDATA[Response content length]]></description>
</bind>
<bind name='headers' type='Properties' export-name="addServerHeaders" ><description><![CDATA[Response headers]]></description>
</bind>
<bind name='contentAsString' type='String' export-name="addServerContentAsString" ><description><![CDATA[Response content as string]]></description>
</bind>
</out-binding><description><![CDATA[Autogenerated workflow.]]></description>
<position x='484.5' y='55.40909090909091'/>
</workflow-item>
<workflow-item name='item4' out-name='item2' type='task' >
<display-name><![CDATA[Build REST content]]></display-name>
<script encoded='false'><![CDATA[//prepare content of the request...
content = '{\n "lbvserver": {\n "name": "' + vserverName + '",\n"servicetype": "'+ vserverProtocol + '",\n';
content += '"ipv46": "'+vserverIP + '",\n "port": "'+vserverPort+'"';
if (vserverComment !== null  && vserverComment.length >= 1){ 
	content += ',\n"comment": "'+ vserverComment + '"';
}

if (vserverLBMethod !== null  && vserverLBMethod.length >=1){ 
	content += ',\n"lbmethod": "'+ vserverLBMethod + '"';
}

if (vserverPersistence !== null && vserverPersistence.length >=1 ){ 
	content += ',\n"persistencetype": "'+ vserverPersistence+ '"';
}


content += '}}';

System.log("content: " + content);

]]></script>
<in-binding><bind name='vserverName' type='string' export-name="vserverName" ></bind>
<bind name='vserverProtocol' type='string' export-name="vserverProtocol" ></bind>
<bind name='vserverIP' type='string' export-name="vserverIP" ></bind>
<bind name='vserverPort' type='string' export-name="vserverPort" ></bind>
<bind name='vserverLBMethod' type='string' export-name="vserverLBMethod" ></bind>
<bind name='vserverPersistence' type='string' export-name="vserverPersistence" ></bind>
<bind name='vserverComment' type='string' export-name="vserverComment" ></bind>
</in-binding><out-binding><bind name='content' type='String' export-name="content" ><description><![CDATA[content]]></description>
</bind>
</out-binding><description><![CDATA[Scripting component to build the JSON content for the REST operation. ]]></description>
<position x='344.5' y='55.40909090909091'/>
</workflow-item>
<presentation>
<p-step>
<title><![CDATA[New step]]></title>
<p-group>
<title><![CDATA[VServer Properties]]></title>
<desc><![CDATA[VServer Properties
]]></desc>
<p-param name="vserverName"><desc><![CDATA[vserverName]]></desc>
</p-param>
<p-param name="vserverProtocol"><desc><![CDATA[vserverProtocol]]></desc>
</p-param>
<p-param name="vserverIP"><desc><![CDATA[vserverIP]]></desc>
</p-param>
<p-param name="vserverPort"><desc><![CDATA[vserverPort]]></desc>
</p-param>
<p-param name="vserverLBMethod"><desc><![CDATA[vserverLBMethod]]></desc>
<p-qual kind="static" name="defaultValue" type="string" ><![CDATA[ROUNDROBIN]]></p-qual></p-param>
<p-param name="vserverPersistence"><desc><![CDATA[vserverPersistence]]></desc>
</p-param>
<p-param name="vserverComment"><desc><![CDATA[vserverComment]]></desc>
</p-param>
</p-group>
<p-group>
<title><![CDATA[PasswordID properties]]></title>
<p-param name="PasswordID"><desc><![CDATA[PasswordID]]></desc>
</p-param>
</p-group>
</p-step>
<p-step>
<title><![CDATA[SSL Info]]></title>
<p-group>
<title><![CDATA[SSL Certificate Information]]></title>
<p-param name="doSSL"><desc><![CDATA[Assign an SSL Certificate]]></desc>
</p-param>
<p-param name="sslCertKey"><desc><![CDATA[sslCertKey]]></desc>
</p-param>
</p-group>
</p-step>
<p-param name="nsRestHostName"><desc><![CDATA[nsRestHostName]]></desc>
</p-param>
</presentation></workflow>